#include<iostream>
#include<vector>
#include <algorithm>
#include"C3_func.h"   
using namespace std;

int main() {
	int a1 = 84 - 1, a2 = 100 - 1, a3 = 40 - 1, k;
	vector< vector<double> >A1(a1 + 1, vector<double>(a1 + 1, 0)), A2(a2 + 1, vector<double>(a2 + 1, 0)), A3(a3 + 1, vector<double>(a3 + 1));
	vector<double>b1(a1 + 1, 0), b2(a2 + 1, 0), b3(a3 + 1, 0);
	//生成第一题的84阶方程组A1
	for (k = 0; k < a1; k++) {
		A1[k][k] = 6;
		A1[k][k + 1] = 1;
		A1[k + 1][k] = 8;
	}
	A1[a1][a1] = 6;

	//生成第一题的b1
	for (k = 1; k < a1; k++)
		b1[k] = 15;
	b1[0] = 7; b1[a1] = 14;
	//生成第二题第一问的系数矩阵A2
	for (k = 0; k < a2; k++) {
		A2[k][k] = 10;
		A2[k][k + 1] = A2[k + 1][k] = 1;
	}
	A2[a2][a2] = 10;

	//生成第二问的随机向量b2
	for (k = 0; k <= a2; k++) {
		b2[k] = (double)(k + 1);
	}
	random_shuffle(b2.begin(), b2.end());

	//生成第二题第二问的系数矩阵A3和b3
	for (int p = 0; p <= a3; p++) {//两个整数相除只保留整数，因此用double
		for (int q = 0; q <= a3; q++) {
			A3[p][q] = 1.0 / (p + q + 1);
			b3[p] += 1.0 / (p + q + 1);
		}
	}
	vector<double>x1 = LS(A1, b1);
	cout << "第一题，第一个方程的解为" << endl;
	for (k = 0; k <= a1; k++) {
		cout << x1[k] << " ";
		if ((k + 1) % 10 == 0)cout << endl;
	}
	cout << endl;
	vector<double>x2 = LS(A2, b2);
	cout << "第一题，第二个方程的解为" << endl;
	for (k = 0; k <= a2; k++) {
		cout << x2[k] << " ";
		if ((k + 1) % 10 == 0)cout << endl;
	}
	cout << endl;
	vector<double>x3 = LS(A3, b3);
	cout << "第一题，第三个方程的解为" << endl;
	for (k = 0; k <= a3; k++) {
		cout << x3[k] << " ";
		if ((k + 1) % 10 == 0)cout << endl;
	}
	cout << endl;
	vector<double>T = { -1,-0.75,-0.5,0,0.25,0.5,0.75 }, Y = { 1.00,0.8125,0.75,1.00,1.3125,1.75,2.3125 },x;
	vector<vector<double>>A(7, vector<double>(3));
	for (int i = 0; i < 7; i++) {
		A[i][0] = T[i] * T[i];
		A[i][1] = T[i];
		A[i][2] = 1;
	}
	x = LS(A, Y);
	cout << "第二题，系数a,b,c分别为" << endl;
	for (k = 0; k <3; k++) {
		cout << x[k] << " ";
	}
	cout << endl;
	vector<vector<double>> B =
	{ {1,4.9176, 1, 3.472, 0.998, 1, 7, 4, 42, 3, 1, 0},
	{1,5.0208, 1, 3.531, 1.5, 2, 7, 4, 62, 1, 1, 0},
	{1,4.5429, 1, 2.275, 1.175, 1, 6, 3, 40,  2, 1, 0},
	{1,4.5573, 1, 4.05, 1.232, 1, 6, 3, 54, 4, 1, 0},
	{1,5.0597, 1, 4.455, 1.121, 1, 6, 3, 42, 3, 1, 0},
	{1,3.891, 1, 4.455, 0.988, 1, 6, 3, 56, 2, 1, 0},
	{1,5.898, 1, 5.85, 1.24, 1, 7, 3, 51, 2, 1,  1},
	{1,5.6039, 1, 9.52, 1.501, 0, 6, 3, 32, 1, 1, 0},
	{1,15.4202, 2.5,  9.8, 3.42, 2, 10, 5, 42, 2, 1, 1},
	{1,14.4598, 2.5, 12.8, 3, 2, 9, 5, 14, 4, 1, 1},
	{1,5.8282, 1, 6.435, 1.225, 2, 6, 3, 32, 1, 1, 0},
	{1,5.3003, 1, 4.9883, 1.552, 1, 6, 3, 30, 1, 2, 0},
	{1,6.2712, 1, 5.52, 0.975, 1, 5, 2, 30, 1, 2, 0},
	{1,5.9592, 1, 6.666, 1.121, 2, 6, 3, 32, 2, 1, 0},
	{1,5.05, 1, 5, 1.02, 0, 5, 2, 46, 4, 1, 1},
	{1,5.6039, 1, 9.52, 1.501, 0, 6, 3, 32, 1, 1, 0},
	{1,8.2464, 1.5, 5.15, 1.664, 2, 8, 4, 50, 4, 1, 0},
	{1,6.6969, 1.5, 6.092, 1.488, 1.5, 7, 3, 22, 1, 1, 1},
	{1,7.7841, 1.5, 7.102, 1.376, 1, 6, 3, 17, 2, 1, 0},
	{1,9.0384, 1, 7.8, 1.5, 1.5, 7, 3, 23, 3, 3, 0},
	{1,5.9894, 1, 5.52, 1.256, 2, 6, 3, 40, 4, 1, 1},
	{1,7.5422, 1.5, 4, 1.69, 1, 6, 3, 22, 1, 1, 0},
	{1,8.7951, 1.5, 9.89, 1.82, 2, 8, 4, 50, 1, 1, 1},
	{1,6.0931, 1.5, 6.7265, 1.652, 1, 6, 3, 44, 4, 1, 0},
	{1,8.3607, 1.5, 9.15, 1.777, 2., 8, 4, 48, 1, 1, 1},
	{1,8.14, 1, 8, 1.504, 2, 7, 3, 3, 1, 3, 0},
	{1,9.1416, 1.5, 7.3262, 1.831, 1.5, 8, 4, 31, 4, 1, 0},
	{1,12, 1.5, 5, 1.2, 2, 6, 3, 30, 3, 1, 1} };

	vector<double> b =
	{ 25.9, 29.5, 27.9, 25.9, 29.9, 29.9, 30.9,
	28.9, 84.9, 82.9, 35.9, 31.5, 31.0, 30.9,
	30.0, 28.9, 36.9, 41.9, 40.5, 43.9, 37.5,
	37.9, 44.5, 37.9, 38.9, 36.9, 45.8, 41.0 };
	vector<double>a = LS(B, b);
	cout << "第三题，x0到x11的解为" << endl;
	for (k = 0; k < 12; k++) {
		cout << a[k] << " ";
	}
	cout << endl;
}
